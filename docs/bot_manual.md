# –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ Telegram-–±–æ—Ç–∞ —Å SQLite

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏](#–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ-–ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π-–æ–±–ª–∞—Å—Ç–∏)
2. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ)
   - [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#1-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
   - [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#2-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
   - [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π](#3-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-–æ—Å–Ω–æ–≤–Ω—ã—Ö-—Ñ—É–Ω–∫—Ü–∏–π)
   - [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#4-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ-–±–æ—Ç–∞)
3. [–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã](#-–ø—Ä–∏–º–µ—Ä—ã-—Ä–∞–±–æ—Ç—ã-–±–æ—Ç–∞)
4. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
5. [–†–µ—Å—É—Ä—Å—ã](#-–ø–æ–ª–µ–∑–Ω—ã–µ-—Ä–µ—Å—É—Ä—Å—ã)

## üîç –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏

### –ê–Ω–∞–ª–∏–∑ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π
**–¶–µ–ª—å:** –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —É—á–µ—Ç–∞ –ª–∏—á–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤  
**–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è:** –§–∏–∑–∏—á–µ—Å–∫–∏–µ –ª–∏—Ü–∞, —Ñ—Ä–∏–ª–∞–Ω—Å–µ—Ä—ã, —Å–µ–º—å–∏  

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- –í–µ–¥–µ–Ω–∏–µ —É—á–µ—Ç–∞ –¥–æ—Ö–æ–¥–æ–≤/—Ä–∞—Å—Ö–æ–¥–æ–≤
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
pip install pyTelegramBotAPI matplotlib pandas  
```
**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**
```bash
finance-bot/
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ financial_data.db
‚îú‚îÄ‚îÄ link.txt
‚îî‚îÄ‚îÄ requirements.txt
```
### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
**–°—Ö–µ–º–∞ –ë–î:**

![–ë–î](images/db_structure.png)

*–†–∏—Å. 1. –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö*

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
```python
def _init_db(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏"""
        with sqlite3.connect(self.db_file) as conn:
            cursor = conn.cursor()
            cursor.execute("""
                CREATE TABLE IF NOT EXISTS transactions (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    user_id INTEGER NOT NULL,
                    type TEXT NOT NULL,
                    category TEXT NOT NULL,
                    amount REAL NOT NULL,
                    date TIMESTAMP NOT NULL,
                    description TEXT
                )
            """)
            conn.commit()
```
### 3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
```python
def add_expense(message):
    """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ """
    user_id = message.from_user.id
    user_data[user_id] = {'state': 'awaiting_category', 'type': 'expense'}
    
    markup = types.InlineKeyboardMarkup(row_width=2)
    buttons = [types.InlineKeyboardButton(cat, callback_data=f"expense_{cat}") 
              for cat in DEFAULT_CATEGORIES['expense']]
    markup.add(*buttons)
    
    bot.send_message(
        message.chat.id, 
        "üìâ –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ä–∞—Å—Ö–æ–¥–∞:", 
        reply_markup=markup
    )
```
**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
```python
def plot_statistics(self, user_id: int, period: str = 'week') -> Optional[str]:
        """–°–æ–∑–¥–∞–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≥—Ä–∞—Ñ–∏–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
        stats = self.get_statistics(user_id, period)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
        if not stats['expenses_by_category'] and not stats['income_by_category']:
            return None

        plt.switch_backend('Agg')  # –í–∞–∂–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö
        plt.style.use('ggplot')
        
        # –°–æ–∑–¥–∞–µ–º —Ñ–∏–≥—É—Ä—É
        fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 6))
        fig.suptitle(f"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ {self._get_period_name(period)}")
        
        # –ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å—Ö–æ–¥–æ–≤
        if stats['expenses_by_category']:
            expenses = stats['expenses_by_category']
            ax1.pie(
                expenses.values(),
                labels=expenses.keys(),
                autopct=lambda p: f'{p:.1f}%\n({p*sum(expenses.values())/100:.2f} ‚ÇΩ)',
                startangle=90
            )
            ax1.set_title('–†–∞—Å—Ö–æ–¥—ã')
        
        # –ì—Ä–∞—Ñ–∏–∫ –¥–æ—Ö–æ–¥–æ–≤
        if stats['income_by_category']:
            income = stats['income_by_category']
            ax2.pie(
                income.values(),
                labels=income.keys(),
                autopct=lambda p: f'{p:.1f}%\n({p*sum(income.values())/100:.2f} ‚ÇΩ)',
                startangle=90
            )
            ax2.set_title('–î–æ—Ö–æ–¥—ã')
        
        plt.tight_layout()
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
        filename = f"chart_{user_id}_{datetime.now().strftime('%Y%m%d%H%M%S')}.png"
        plt.savefig(filename, dpi=100, bbox_inches='tight')
        plt.close()
        
        return filename
```
### 4. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –±–æ—Ç–∞
**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π:**
1. –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω —É @BotFather
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
   ```python
   TOKEN = '–¢–æ–∫–µ–Ω'
   DB_FILE = 'financial_data.db'
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞:
   ```python
   python bot.py
   ```
## –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
**–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:**

![–ú–µ–Ω—é](images/menu.png)

*–†–∏—Å. 2. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é*

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞:**

![–†–∞—Å—Ö–æ–¥—ã](images/expense.png)

*–†–∏—Å. 3. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤*

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**

![–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞](images/statistic.png)

*–†–∏—Å. 4. –í—ã–≤–µ–¥–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏*

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–æ—Ç–∞
